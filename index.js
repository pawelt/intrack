(()=>{var ye=(e,t,...r)=>{if(typeof e=="function")return e(t||{},...r);let n=document.createElement(e);return Object.entries(t||{}).forEach(([a,o])=>{a.startsWith("on")&&typeof o=="function"?n.addEventListener(a.substring(2).toLowerCase(),o):a.startsWith("data-")?n.dataset[a.substring(5)]=""+o:a==="xname"||a==="xid"?n.dataset[a]=""+o:n.setAttribute(a,""+o)}),r.flat().forEach(a=>{n.appendChild(typeof a=="object"?a:document.createTextNode(a))}),n};var ve={},x=(e,t)=>{let{type:r}=e({});for(let n of ve[r]||[])n(t);return!0},f=(e,t)=>{let{type:r}=e({});return ve[r]=ve[r]||[],ve[r].push(t),!0};var nt=({url:e=window.location.href,pathname:t,searchAdd:r,searchSet:n})=>{let a=new URL(""+e);a.pathname=t??a.pathname;let o=r??n;if(!o)return a;let s=new URLSearchParams(r?a.search:"");for(let i in o){let c=o[i];Array.isArray(c)?(s.delete(i),c.forEach(u=>s.append(i,u))):c!==void 0?s.set(i,c):s.delete(i)}return a.search=""+s,a},be=e=>({type:"router:navigate",payload:e}),ot=e=>{let t=""+e;window.history.pushState(null,"",t),x(be,{newUrl:new URL(t)})};window.addEventListener("popstate",()=>{x(be,{newUrl:new URL(window.location.href)})});var Ee=()=>new URLSearchParams(window.location.search).get("view")||"home";var at="todos",B=[],De=e=>({type:"store:item-created",payload:e}),Mr=e=>({type:"store:item-updated",payload:e}),Ue=e=>({type:"store:item-deleted",payload:e}),st=()=>B,it=async e=>{let t={text:e,done:!1,id:new Date().toISOString()};return B.push(t),_e().then(()=>x(De,{todo:t}))},ct=async e=>{let t=B.find(r=>r.id===e.id);return t?(Object.assign(t,e),_e().then(()=>x(Mr,{todo:t}))):!1},lt=async e=>{let t=B.findIndex(r=>r.id===e);return t<0?!1:(B.splice(t,1),_e().then(()=>x(Ue,{todoId:e})))},ut=async()=>{B=JSON.parse(localStorage.getItem(at)||"[]"),console.log({todos:B})},_e=async()=>{localStorage.setItem(at,JSON.stringify(B))};var dt=e=>fetch(`https://it.nottycanvas.com?target=${e}`),Se=[{name:"ose-funds",description:"Oslo B\xF8rs - Funds",matchSource:e=>e.includes("markedsaktivitet/#/details/")&&e.includes("oslobors.no/"),fetchInitialData:async e=>{try{if(!e.sourceUrl){alert("Error: empty source URL");return}let t=(e.sourceUrl.match(/details\/([^/]+)\/overview/)||[])[1],r=`https://www.oslobors.no/ob/servlets/components?type=header&source=feed.omff.FUNDS&view=REALTIME&columns=ITEM%2C+ISIN%2C+SECURITYNAME+as+LONG_NAME%2C&filter=ITEM_SECTOR%3D%3Ds${t}`,n=await(await dt(r)).json(),{ISIN:a,LONG_NAME:o}=n.rows[0].values;return Object.assign(e,{name:o,isin:a,code:t}),e}catch(t){alert("Failed to fetch initial data: "+t);return}},fetchCurrentPrice:async e=>{try{if(!e.code){console.log("Error: instrument code is missing in:",e);return}let t=`https://www.oslobors.no/ob/servlets/components?source=feed.omff.FUNDS&view=REALTIME&columns=ITEM%2C+PRICECHANGEPCT%2C+TRADE_TIME%2C+PRICE%2C+DATE%2C+LAST%2C+CHANGE&filter=ITEM_SECTOR%3D%3Ds${e.code}`,r=await(await dt(t)).json();return e.latestPrice=+r.rows[0].values.PRICE.toFixed(2),!0}catch(t){return alert("Failed to fetch current price: "+t),!1}}}];var $e="instruments",R={},U=e=>({type:"store:instruments-updated",payload:e}),de=()=>Object.values(R),J=()=>R,mt=async e=>{if(R[e.code])return!1;let t={...e};return t.latestUpdate=new Date().toISOString(),R[t.code]=t,We().then(()=>x(U,{changes:[{instrument:e,op:"create"}]}))},Cr=async e=>{let{code:t=""}=e;if(!R[t])return!1;let r=R[t];return Object.assign(r,e),r.latestUpdate=new Date().toISOString(),We().then(()=>x(U,{changes:[{instrument:r,op:"update"}]}))},pt=async e=>{if(!R[e])return!1;let t=R[e];return delete R[e],We().then(()=>x(U,{changes:[{instrument:t,op:"delete"}]}))},Nr=async()=>{R=JSON.parse(localStorage.getItem($e)||"{}"),console.log({instruments:R})},We=async()=>{localStorage.setItem($e,JSON.stringify(R))},ft=async e=>{localStorage.setItem($e,JSON.stringify(e)),R=e},kr=.5,Lr=10,ht=async()=>{let e=[];for(let t of de())if(!t.latestUpdate||new Date(t.latestUpdate).getTime()<Date.now()-kr*60*1e3){let r=Se.find(n=>n.name===t.sourceName);if(!r){console.log("Error: source not found:",t);continue}await r.fetchCurrentPrice(t)&&(await Cr(t),e.push({instrument:t,op:"update"}))}e.length&&x(U,{changes:e}),setTimeout(ht,Lr*1e3)};Nr().then(ht);var Fe="wallets",_={},He=e=>({type:"store:wallet-created",payload:e}),Rr=e=>({type:"store:wallet-updated",payload:e}),Or=e=>({type:"store:wallets-updated",payload:e});var gt=()=>Object.values(_),me=()=>_,xt=async e=>{if(_[e.name])return!1;let t={...e};return _[t.name]=t,wt().then(()=>x(He,{wallet:t}))},ze=async e=>{let{name:t=""}=e;return _[t]?(_[t]=e,wt().then(()=>x(Rr,{wallet:e}))):!1};var Ar=async()=>{_=JSON.parse(localStorage.getItem(Fe)||"{}"),console.log({wallets:_})},wt=async()=>{localStorage.setItem(Fe,JSON.stringify(_))},yt=async e=>{localStorage.setItem(Fe,JSON.stringify(e)),_=e};Ar().then(()=>x(Or,{}));var Ge=e=>t=>({type:e,payload:t}),Be=e=>t=>{let{xname:r="",xid:n=""}=t.target.dataset;r&&x(Ge(`${r}:${e}`),{xname:r,xid:n,ev:t})},vt=()=>{document.addEventListener("click",Be("click")),document.addEventListener("keyup",Be("keyup")),document.addEventListener("keydown",Be("keydown"))},T=e=>Ge(e),je=e=>Ge(e),v=({el:e=document,sel:t="",xname:r,xid:n})=>{let a=`[data-xname="${r}"]`,o=n?`[data-xid="${n}"]`:"";return e.querySelector(`${t}${a}${o}`)},qe=({el:e=document,sel:t="",xname:r,xid:n})=>{let a=`[data-xname="${r}"]`,o=n?`[data-xid="${n}"]`:"";return e.querySelector(`${t}${a}${o}`)},q=(e,t)=>{if(!e)return;let r=e;if(r.querySelector){r.value=""+t;return}let n=v(e);n&&(n.value=""+t)},K=(e,t)=>{if(!e)return t;let r=e;if(r.querySelector)return r.value;let n=v(e);return n?n.value:t};function Pr(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function Vr(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var bt=function(){function e(r){var n=this;this._insertTag=function(a){var o;n.tags.length===0?n.insertionPoint?o=n.insertionPoint.nextSibling:n.prepend?o=n.container.firstChild:o=n.before:o=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(a,o),n.tags.push(a)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(n){n.forEach(this._insertTag)},t.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Vr(this));var a=this.tags[this.tags.length-1];if(!1)var o;if(this.isSpeedy){var s=Pr(a);try{s.insertRule(n,s.cssRules.length)}catch{}}else a.appendChild(document.createTextNode(n));this.ctr++},t.flush=function(){this.tags.forEach(function(n){return n.parentNode&&n.parentNode.removeChild(n)}),this.tags=[],this.ctr=0},e}();var b="-ms-",Z="-moz-",d="-webkit-",Te="comm",Q="rule",X="decl";var Et="@import";var Ie="@keyframes";var St=Math.abs,Y=String.fromCharCode,Tt=Object.assign;function It(e,t){return(((t<<2^E(e,0))<<2^E(e,1))<<2^E(e,2))<<2^E(e,3)}function Me(e){return e.trim()}function Mt(e,t){return(e=t.exec(e))?e[0]:e}function m(e,t,r){return e.replace(t,r)}function pe(e,t){return e.indexOf(t)}function E(e,t){return e.charCodeAt(t)|0}function G(e,t,r){return e.slice(t,r)}function I(e){return e.length}function ee(e){return e.length}function te(e,t){return t.push(e),e}function Ct(e,t){return e.map(t).join("")}var Ce=1,re=1,Nt=0,M=0,w=0,oe="";function fe(e,t,r,n,a,o,s){return{value:e,root:t,parent:r,type:n,props:a,children:o,line:Ce,column:re,length:s,return:""}}function ae(e,t){return Tt(fe("",null,null,"",null,null,0),e,{length:-e.length},t)}function kt(){return w}function Lt(){return w=M>0?E(oe,--M):0,re--,w===10&&(re=1,Ce--),w}function C(){return w=M<Nt?E(oe,M++):0,re++,w===10&&(re=1,Ce++),w}function A(){return E(oe,M)}function he(){return M}function se(e,t){return G(oe,e,t)}function ne(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ne(e){return Ce=re=1,Nt=I(oe=e),M=0,[]}function ke(e){return oe="",e}function ie(e){return Me(se(M-1,Ke(e===91?e+2:e===40?e+1:e)))}function Rt(e){for(;(w=A())&&w<33;)C();return ne(e)>2||ne(w)>3?"":" "}function Ot(e,t){for(;--t&&C()&&!(w<48||w>102||w>57&&w<65||w>70&&w<97););return se(e,he()+(t<6&&A()==32&&C()==32))}function Ke(e){for(;C();)switch(w){case e:return M;case 34:case 39:e!==34&&e!==39&&Ke(w);break;case 40:e===41&&Ke(e);break;case 92:C();break}return M}function At(e,t){for(;C()&&e+w!==47+10;)if(e+w===42+42&&A()===47)break;return"/*"+se(t,M-1)+"*"+Y(e===47?e:C())}function Pt(e){for(;!ne(A());)C();return se(e,M)}function Ut(e){return ke(Le("",null,null,null,[""],e=Ne(e),0,[0],e))}function Le(e,t,r,n,a,o,s,i,c){for(var u=0,l=0,p=s,N=0,F=0,L=0,h=1,k=1,y=1,S=0,V="",ue=a,z=o,D=n,g=V;k;)switch(L=S,S=C()){case 40:if(L!=108&&g.charCodeAt(p-1)==58){pe(g+=m(ie(S),"&","&\f"),"&\f")!=-1&&(y=-1);break}case 34:case 39:case 91:g+=ie(S);break;case 9:case 10:case 13:case 32:g+=Rt(L);break;case 92:g+=Ot(he()-1,7);continue;case 47:switch(A()){case 42:case 47:te(Dr(At(C(),he()),t,r),c);break;default:g+="/"}break;case 123*h:i[u++]=I(g)*y;case 125*h:case 59:case 0:switch(S){case 0:case 125:k=0;case 59+l:F>0&&I(g)-p&&te(F>32?Dt(g+";",n,r,p-1):Dt(m(g," ","")+";",n,r,p-2),c);break;case 59:g+=";";default:if(te(D=Vt(g,t,r,u,l,a,i,V,ue=[],z=[],p),o),S===123)if(l===0)Le(g,t,D,D,ue,o,p,i,z);else switch(N){case 100:case 109:case 115:Le(e,D,D,n&&te(Vt(e,D,D,0,0,a,i,V,a,ue=[],p),z),a,z,p,i,n?ue:z);break;default:Le(g,D,D,D,[""],z,0,i,z)}}u=l=F=0,h=y=1,V=g="",p=s;break;case 58:p=1+I(g),F=L;default:if(h<1){if(S==123)--h;else if(S==125&&h++==0&&Lt()==125)continue}switch(g+=Y(S),S*h){case 38:y=l>0?1:(g+="\f",-1);break;case 44:i[u++]=(I(g)-1)*y,y=1;break;case 64:A()===45&&(g+=ie(C())),N=A(),l=p=I(V=g+=Pt(he())),S++;break;case 45:L===45&&I(g)==2&&(h=0)}}return o}function Vt(e,t,r,n,a,o,s,i,c,u,l){for(var p=a-1,N=a===0?o:[""],F=ee(N),L=0,h=0,k=0;L<n;++L)for(var y=0,S=G(e,p+1,p=St(h=s[L])),V=e;y<F;++y)(V=Me(h>0?N[y]+" "+S:m(S,/&\f/g,N[y])))&&(c[k++]=V);return fe(e,t,r,a===0?Q:i,c,u,l)}function Dr(e,t,r){return fe(e,t,r,Te,Y(kt()),G(e,2,-2),0)}function Dt(e,t,r,n){return fe(e,t,r,X,G(e,0,n),G(e,n+1,-1),n)}function Ye(e,t){switch(It(e,t)){case 5103:return d+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return d+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return d+e+Z+e+b+e+e;case 6828:case 4268:return d+e+b+e+e;case 6165:return d+e+b+"flex-"+e+e;case 5187:return d+e+m(e,/(\w+).+(:[^]+)/,d+"box-$1$2"+b+"flex-$1$2")+e;case 5443:return d+e+b+"flex-item-"+m(e,/flex-|-self/,"")+e;case 4675:return d+e+b+"flex-line-pack"+m(e,/align-content|flex-|-self/,"")+e;case 5548:return d+e+b+m(e,"shrink","negative")+e;case 5292:return d+e+b+m(e,"basis","preferred-size")+e;case 6060:return d+"box-"+m(e,"-grow","")+d+e+b+m(e,"grow","positive")+e;case 4554:return d+m(e,/([^-])(transform)/g,"$1"+d+"$2")+e;case 6187:return m(m(m(e,/(zoom-|grab)/,d+"$1"),/(image-set)/,d+"$1"),e,"")+e;case 5495:case 3959:return m(e,/(image-set\([^]*)/,d+"$1$`$1");case 4968:return m(m(e,/(.+:)(flex-)?(.*)/,d+"box-pack:$3"+b+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+d+e+e;case 4095:case 3583:case 4068:case 2532:return m(e,/(.+)-inline(.+)/,d+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(I(e)-1-t>6)switch(E(e,t+1)){case 109:if(E(e,t+4)!==45)break;case 102:return m(e,/(.+:)(.+)-([^]+)/,"$1"+d+"$2-$3$1"+Z+(E(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~pe(e,"stretch")?Ye(m(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(E(e,t+1)!==115)break;case 6444:switch(E(e,I(e)-3-(~pe(e,"!important")&&10))){case 107:return m(e,":",":"+d)+e;case 101:return m(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+d+(E(e,14)===45?"inline-":"")+"box$3$1"+d+"$2$3$1"+b+"$2box$3")+e}break;case 5936:switch(E(e,t+11)){case 114:return d+e+b+m(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return d+e+b+m(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return d+e+b+m(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return d+e+b+e+e}return e}function j(e,t){for(var r="",n=ee(e),a=0;a<n;a++)r+=t(e[a],a,e,t)||"";return r}function _t(e,t,r,n){switch(e.type){case Et:case X:return e.return=e.return||e.value;case Te:return"";case Ie:return e.return=e.value+"{"+j(e.children,n)+"}";case Q:e.value=e.props.join(",")}return I(r=j(e.children,n))?e.return=e.value+"{"+r+"}":""}function $t(e){var t=ee(e);return function(r,n,a,o){for(var s="",i=0;i<t;i++)s+=e[i](r,n,a,o)||"";return s}}function Wt(e){return function(t){t.root||(t=t.return)&&e(t)}}function Ft(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case X:e.return=Ye(e.value,e.length);break;case Ie:return j([ae(e,{value:m(e.value,"@","@"+d)})],n);case Q:if(e.length)return Ct(e.props,function(a){switch(Mt(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return j([ae(e,{props:[m(a,/:(read-\w+)/,":"+Z+"$1")]})],n);case"::placeholder":return j([ae(e,{props:[m(a,/:(plac\w+)/,":"+d+"input-$1")]}),ae(e,{props:[m(a,/:(plac\w+)/,":"+Z+"$1")]}),ae(e,{props:[m(a,/:(plac\w+)/,b+"input-$1")]})],n)}return""})}}function Ur(e){var t=Object.create(null);return function(r){return t[r]===void 0&&(t[r]=e(r)),t[r]}}var Ht=Ur;var _r=function(t,r,n){for(var a=0,o=0;a=o,o=A(),a===38&&o===12&&(r[n]=1),!ne(o);)C();return se(t,M)},$r=function(t,r){var n=-1,a=44;do switch(ne(a)){case 0:a===38&&A()===12&&(r[n]=1),t[n]+=_r(M-1,r,n);break;case 2:t[n]+=ie(a);break;case 4:if(a===44){t[++n]=A()===58?"&\f":"",r[n]=t[n].length;break}default:t[n]+=Y(a)}while(a=C());return t},Wr=function(t,r){return ke($r(Ne(t),r))},zt=new WeakMap,Fr=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var r=t.value,n=t.parent,a=t.column===n.column&&t.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(t.props.length===1&&r.charCodeAt(0)!==58&&!zt.get(n))&&!a){zt.set(t,!0);for(var o=[],s=Wr(r,o),i=n.props,c=0,u=0;c<s.length;c++)for(var l=0;l<i.length;l++,u++)t.props[u]=o[c]?s[c].replace(/&\f/g,i[l]):i[l]+" "+s[c]}}},Hr=function(t){if(t.type==="decl"){var r=t.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(t.return="",t.value="")}};var zr=[Ft],Br=function(t){var r=t.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(h){var k=h.getAttribute("data-emotion");k.indexOf(" ")!==-1&&(document.head.appendChild(h),h.setAttribute("data-s",""))})}var a=t.stylisPlugins||zr,o={},s,i=[];s=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(h){for(var k=h.getAttribute("data-emotion").split(" "),y=1;y<k.length;y++)o[k[y]]=!0;i.push(h)});var c,u=[Fr,Hr];{var l,p=[_t,Wt(function(h){l.insert(h)})],N=$t(u.concat(a,p)),F=function(k){return j(Ut(k),N)};c=function(k,y,S,V){l=S,F(k?k+"{"+y.styles+"}":y.styles),V&&(L.inserted[y.name]=!0)}}var L={key:r,sheet:new bt({key:r,container:s,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:c};return L.sheet.hydrate(i),L},Bt=Br;function Gr(e){for(var t=0,r,n=0,a=e.length;a>=4;++n,a-=4)r=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,t=(r&65535)*1540483477+((r>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(a){case 3:t^=(e.charCodeAt(n+2)&255)<<16;case 2:t^=(e.charCodeAt(n+1)&255)<<8;case 1:t^=e.charCodeAt(n)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Gt=Gr;var jr={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},jt=jr;var qr=/[A-Z]|^ms/g,Kr=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Jt=function(t){return t.charCodeAt(1)===45},qt=function(t){return t!=null&&typeof t!="boolean"},Je=Ht(function(e){return Jt(e)?e:e.replace(qr,"-$&").toLowerCase()}),Kt=function(t,r){switch(t){case"animation":case"animationName":if(typeof r=="string")return r.replace(Kr,function(n,a,o){return $={name:a,styles:o,next:$},a})}return jt[t]!==1&&!Jt(t)&&typeof r=="number"&&r!==0?r+"px":r};function ge(e,t,r){if(r==null)return"";if(r.__emotion_styles!==void 0)return r;switch(typeof r){case"boolean":return"";case"object":{if(r.anim===1)return $={name:r.name,styles:r.styles,next:$},r.name;if(r.styles!==void 0){var n=r.next;if(n!==void 0)for(;n!==void 0;)$={name:n.name,styles:n.styles,next:$},n=n.next;var a=r.styles+";";return a}return Yr(e,t,r)}case"function":{if(e!==void 0){var o=$,s=r(e);return $=o,ge(e,t,s)}break}case"string":if(!1)var i,c;break}if(t==null)return r;var u=t[r];return u!==void 0?u:r}function Yr(e,t,r){var n="";if(Array.isArray(r))for(var a=0;a<r.length;a++)n+=ge(e,t,r[a])+";";else for(var o in r){var s=r[o];if(typeof s!="object")t!=null&&t[s]!==void 0?n+=o+"{"+t[s]+"}":qt(s)&&(n+=Je(o)+":"+Kt(o,s)+";");else if(Array.isArray(s)&&typeof s[0]=="string"&&(t==null||t[s[0]]===void 0))for(var i=0;i<s.length;i++)qt(s[i])&&(n+=Je(o)+":"+Kt(o,s[i])+";");else{var c=ge(e,t,s);switch(o){case"animation":case"animationName":{n+=Je(o)+":"+c+";";break}default:n+=o+"{"+c+"}"}}}return n}var Yt=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var $,Re=function(t,r,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var a=!0,o="";$=void 0;var s=t[0];s==null||s.raw===void 0?(a=!1,o+=ge(n,r,s)):o+=s[0];for(var i=1;i<t.length;i++)o+=ge(n,r,t[i]),a&&(o+=s[i]);var c;Yt.lastIndex=0;for(var u="",l;(l=Yt.exec(o))!==null;)u+="-"+l[1];var p=Gt(o)+u;return{name:p,styles:o,next:$}};var Jr=!0;function Ze(e,t,r){var n="";return r.split(" ").forEach(function(a){e[a]!==void 0?t.push(e[a]+";"):n+=a+" "}),n}var Zt=function(t,r,n){var a=t.key+"-"+r.name;if((n===!1||Jr===!1)&&t.registered[a]===void 0&&(t.registered[a]=r.styles),t.inserted[r.name]===void 0){var o=r;do{var s=t.insert(r===o?"."+a:"",o,t.sheet,!0);o=o.next}while(o!==void 0)}};function Qt(e,t){if(e.inserted[t.name]===void 0)return e.insert("",t,e.sheet,!0)}function Xt(e,t,r){var n=[],a=Ze(e,n,r);return n.length<2?r:a+t(n)}var Zr=function(t){var r=Bt(t);r.sheet.speedy=function(i){this.isSpeedy=i},r.compat=!0;var n=function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];var p=Re(u,r.registered,void 0);return Zt(r,p,!1),r.key+"-"+p.name},a=function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];var p=Re(u,r.registered),N="animation-"+p.name;return Qt(r,{name:p.name,styles:"@keyframes "+N+"{"+p.styles+"}"}),N},o=function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];var p=Re(u,r.registered);Qt(r,p)},s=function(){for(var c=arguments.length,u=new Array(c),l=0;l<c;l++)u[l]=arguments[l];return Xt(r.registered,n,Qr(u))};return{css:n,cx:s,injectGlobal:o,keyframes:a,hydrate:function(c){c.forEach(function(u){r.inserted[u]=!0})},flush:function(){r.registered={},r.inserted={},r.sheet.flush()},sheet:r.sheet,cache:r,getRegisteredStyles:Ze.bind(null,r.registered),merge:Xt.bind(null,r.registered,n)}},Qr=function e(t){for(var r="",n=0;n<t.length;n++){var a=t[n];if(a!=null){var o=void 0;switch(typeof a){case"boolean":break;case"object":{if(Array.isArray(a))o=e(a);else{o="";for(var s in a)a[s]&&s&&(o&&(o+=" "),o+=s)}break}default:o=a}o&&(r&&(r+=" "),r+=o)}}return r},er=Zr;var W=er({key:"css"}),Io=W.flush,Mo=W.hydrate,Co=W.cx,No=W.merge,ko=W.getRegisteredStyles,tr=W.injectGlobal,Lo=W.keyframes,P=W.css,Ro=W.sheet,Oo=W.cache;var Xr=P`
  cursor: pointer;
`,en=P`
  border: 0;
  color: blue;
  background: transparent;
  cursor: pointer;
  font-size: 0.85rem;
  &:hover {
    text-decoration: underline;
  }
`,O=(e,...t)=>{let r={...e};return r.disabled||delete r.disabled,ye("button",{class:r.variant==="text"?en:Xr,...r},t)},Qe=(e,...t)=>{let r={...e},{view:n}=e;return n&&(r.href=""+nt({searchSet:{view:n}})),ye("a",{"data-to":r.href,onClick:a=>{a.preventDefault();let{href:o}=a.currentTarget;o&&ot(o)},...r},t)};var rr=()=>Elem("div",null,Elem("p",null,"This app does NOT send any data to the server. Anything you save is stored in your browser's local storage only."),Elem("p",null,"Start with defining some instruments, then add them to a wallet.")),nr=async()=>{console.log("ViewHome mounted!")};var or=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e(...n),t)}};var tn=new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"medium"}),rn=new Intl.DateTimeFormat("en-GB",{dateStyle:"short"}),nn=new Intl.NumberFormat("no-NB",{minimumFractionDigits:2,maximumFractionDigits:2}),ar=e=>tn.format(typeof e=="string"?new Date(e):e),Xe=e=>{let t=rn.formatToParts(typeof e=="string"?new Date(e):e);return`${t[4].value}-${t[2].value}-${t[0].value}`},H=e=>nn.format(e);var on=P`
  -label: view-instruments;

  [data-xname='new-instrument'] {
    width: 500px;
    font-size: 0.8rem;
  }
  [data-xname='instrument-list'] {
    .right {
      text-align: right;
    }
    .small {
      font-size: 0.9rem;
    }
    td {
      padding: 0.4rem 0.8rem;
    }
    td:first-child {
      padding-left: 0;
    }
  }
`,rt,xe,et=e=>Elem("tr",{xname:"instrument",xid:e.code},Elem("td",null,Elem("a",{href:e.sourceUrl,target:"_blank"},Elem("strong",null,e.name))),Elem("td",{class:"right"},Elem("strong",null,e.latestPrice.toFixed(2))),Elem("td",null,e.code),Elem("td",{class:"small"},ar(e.latestUpdate)),Elem("td",null,Elem(O,{xname:"instrument-delete",xid:e.code,variant:"text"},"Delete"),Elem("input",{value:"test "}))),sr=({changes:e}={})=>{if(!e){xe.replaceChildren(...de().map(et));return}for(let t of e){let r=v({xname:"instrument",xid:t.instrument.code});switch(t.op){case"create":xe.appendChild(et(t.instrument));break;case"update":r&&xe.replaceChild(et(t.instrument),r);break;case"delete":r&&xe.removeChild(r);break}}},ir=async()=>{rt=qe({xname:"new-instrument"}),xe=qe({xname:"instrument-list"}),sr(),console.log("ViewInstruments mounted!")},tt=()=>rt.value="";f(U,sr);f(T("clear-new-instrument:click"),tt);f(T("add-new-instrument:click"),async()=>{let e=rt.value,t=Se.find(n=>n.matchSource(e));if(!t){alert("Unrecognised URL");return}let r={sourceUrl:e,sourceName:t.name};if(await t.fetchInitialData(r),!r.name){alert("Failed to fetch instrument data");return}if(J()[r.code||""]){tt();return}if(!await t.fetchCurrentPrice(r)){alert("Failed to fetch instrument data");return}await mt(r),tt()});f(T("instrument-delete:click"),async({xid:e})=>{!e||!confirm("Removing instrument:  "+e+`
It will NOT be removed from wallets (you will need to do it manually)`)||await pt(e)});var cr=()=>Elem("div",{class:on},Elem("div",null,"Paste the URL of the instrument you want to track. Supported websites:",Elem("ul",null,Elem("li",null,Elem("a",{href:"https://www.euronext.com/nb/markets/oslo"},"oslobors / euronext")," ",Elem("small",null,"( for example:"," ",Elem("a",{href:"https://www.oslobors.no/ob_eng/markedsaktivitet/#/details/DK-GLOIN.OSE/overview",target:"_blank"},"https://www.oslobors.no/ob_eng/markedsaktivitet/#/details/DK-GLOIN.OSE/overview")," ",")")))),Elem("div",null,Elem("input",{xname:"new-instrument"}),"  ",Elem(O,{xname:"add-new-instrument"},"Add instrument"),"  ",Elem(O,{xname:"clear-new-instrument",variant:"text"},"Clear")),Elem("h2",null,"Tracked instruments"),Elem("table",{xname:"instrument-list"}));var an=P`
  -label: view-wallets;

  [data-xname='new-wallet-name'] {
    width: 200px;
    font-size: 0.8rem;
  }
  [data-xname='new-wallet-comment'] {
    width: 500px;
    font-size: 0.8rem;
  }
  [data-xname='wallet-list'] {
  }

  [data-xname='wallet'] {
    margin-bottom: 2rem;
    .title {
      background-color: #ccc;
      * {
        padding: 0.5rem 1rem;
        display: inline-block;
      }
    }
    .name {
      font-size: 1.2rem;
      margin-right: 1rem;
    }
    .comment {
    }
  }
  [data-xname='instruments'] {
    border-collapse: collapse;
    border: 0;
    /* width: 100%; */
    font-size: 0.85rem;
    tr {
      border: 1px solid gray;
    }
    td,
    th {
      padding: 0.4rem 0;
    }
    td:first-child,
    th:first-child {
      padding-left: 0.4rem;
    }
    td:last-child,
    th:last-child {
      padding-right: 0.4rem;
    }
    .instrument-name {
      text-align: left;
    }
    .price {
      text-align: right;
      width: 100px;
      input {
        width: 80px;
        text-align: right;
      }
    }
    .percent {
      text-align: right;
      width: 60px;
    }
    .date {
      width: 130px;
      text-align: right;
    }
    .actions {
      text-align: right;
      width: 100px;
    }
    .total {
      font-size: 0.75rem;
      font-weight: bold;
    }
  }
`,Oe=null,Ae=null,lr=null,ur=()=>{Oe&&(Oe.value=""),Ae&&(Ae.value="")};f(T("add-new-wallet:click"),async()=>{let e=Oe?.value||"",t=Ae?.value||"";if(!e)return;if(!await xt({name:e,comment:t,instruments:[]})){alert("Failed to create a wallet");return}ur()});f(T("clear-new-wallet:click"),()=>{ur()});var dr=e=>{!e||(q({el:e,xname:"wallet-new-total-price"},""),q({el:e,xname:"wallet-new-unit-price"},""),q({el:e,xname:"wallet-new-date"},Xe(new Date)),q({el:e,xname:"wallet-new-instrument"},""))};f(T("wallet-new-clear-instrument:click"),({xid:e=""})=>{dr(v({xname:"wallet",xid:e}))});f(T("wallet-delete-instrument:click"),({xid:e=""})=>{let[t,r]=e.split(":"),n=me()[t],a=n.instruments.find(({id:o})=>""+o===r);!n||!confirm("Remove instrument "+a?.code+" from wallet "+n.name+"?")||(n.instruments=n.instruments.filter(({id:o})=>""+o!==r),ze(n),we())});f(T("wallet-new-add-instrument:click"),({xid:e=""})=>{let t=me()[e];if(!t){alert("Wallet "+e+" not found");return}let r=v({xname:"wallet",xid:e});if(!r){alert("$wallet "+e+" not found");return}t.instruments.push({id:Date.now(),code:K({el:r,xname:"wallet-new-instrument"},""),date:K({el:r,xname:"wallet-new-date"},""),totalPrice:+K({el:r,xname:"wallet-new-total-price"},""),unitPrice:+K({el:r,xname:"wallet-new-unit-price"},"")}),ze(t),dr(r),we()});var sn=e=>{let t=J(),r=e.instruments.map(o=>{let s=t[o.code]?.latestPrice||0,i=o.totalPrice/o.unitPrice,c=s*i;return{id:o.id,instrumentName:t[o.code]?.name??"???",instrumentUrl:t[o.code]?.sourceUrl,change:c/o.totalPrice*100-100,currentTotal:c,currentUnit:s,unitCount:i,paidTotal:o.totalPrice,paidUnit:o.unitPrice,paidDate:o.date}}),n=r.reduce((o,s)=>o+s.currentTotal,0),a=r.reduce((o,s)=>o+s.paidTotal,0);return Elem("div",{xname:"wallet",xid:e.name},Elem("div",{class:"title"},Elem("span",{class:"name"},e.name),Elem("span",{class:"comment"},e.comment)),Elem("table",{xname:"instruments",xid:e.name},Elem("tr",null,Elem("th",{class:"instrument-name"},"Instrument"),Elem("th",{class:"price"},"Change"),Elem("th",{class:"percent"},"%"),Elem("th",{class:"price"},"Total value"),Elem("th",{class:"price"},"Total price"),Elem("th",{class:"price"},"Unit value"),Elem("th",{class:"price"},"Unit count"),Elem("th",{class:"price"},"Unit price"),Elem("th",{class:"date"},"Date"),Elem("th",{class:"actions"})),r.map(o=>Elem("tr",null,Elem("td",{class:"instrument-name"},Elem("a",{href:o.instrumentUrl,target:"_blank"},o.instrumentName)),Elem("td",{class:"price"},H(o.currentTotal-o.paidTotal)),Elem("td",{class:"percent"},o.change.toFixed(2)),Elem("td",{class:"price"},H(o.currentTotal)),Elem("td",{class:"price"},H(o.paidTotal)),Elem("td",{class:"price"},H(o.currentUnit)),Elem("td",{class:"price"},o.unitCount.toFixed(2)),Elem("td",{class:"price"},H(o.paidUnit)),Elem("td",{class:"date"},o.paidDate),Elem("td",{class:"actions"},Elem(O,{xname:"wallet-delete-instrument",xid:`${e.name}:${o.id}`,variant:"text"},"Delete")))),Elem("tr",{class:"total"},Elem("td",{class:"instrument-name"},"Total"),Elem("td",{class:"price"},H(n-a)),Elem("td",{class:"percent"},(n/a*100-100).toFixed(2)),Elem("td",{class:"price"},H(n)),Elem("td",{class:"price"},H(a)),Elem("td",{class:"price"}),Elem("td",{class:"price"}),Elem("td",{class:"price"}),Elem("td",{class:"date"}),Elem("td",{class:"actions"})),Elem("tr",null,Elem("td",null,Elem("select",{xname:"wallet-new-instrument",xid:e.name},Elem("option",{value:""}),de().map(o=>Elem("option",{value:o.code},o.name)))),Elem("td",null),Elem("td",null),Elem("td",null),Elem("td",{class:"price"},Elem("input",{type:"number",xname:"wallet-new-total-price",xid:e.name})),Elem("td",null),Elem("td",null),Elem("td",{class:"price"},Elem("input",{type:"number",xname:"wallet-new-unit-price",xid:e.name})),Elem("td",{class:"date"},Elem("input",{type:"date",xname:"wallet-new-date",xid:e.name,pattern:"yyyy-mm-dd",value:Xe(new Date)})),Elem("td",{class:"actions"},Elem(O,{xname:"wallet-new-add-instrument",xid:e.name},"Add"),Elem(O,{xname:"wallet-new-clear-instrument",xid:e.name,variant:"text"},"Clear")))))},we=()=>{lr?.replaceChildren(...gt().map(sn))};f(He,we);f(U,we);var mr=()=>Elem("div",{class:an},Elem("div",null,Elem("input",{xname:"new-wallet-name"}),"  ",Elem("input",{xname:"new-wallet-comment"}),"  ",Elem(O,{xname:"add-new-wallet"},"Create wallet"),"  ",Elem(O,{xname:"clear-new-wallet",variant:"text"},"Clear")),Elem("h2",null,"Your wallets"),Elem("div",{xname:"wallet-list"})),pr=async()=>{Oe=v({xname:"new-wallet-name"}),Ae=v({xname:"new-wallet-comment"}),lr=v({xname:"wallet-list"}),we(),console.log("ViewWallets mounted!")};var le=null,ce=null,fr=e=>Elem("li",{xname:"todo",xid:e.id},Elem("button",{xname:"todo-delete",xid:e.id}," X "),"\xA0",Elem("input",{xname:"todo-text",xid:e.id,value:e.text})),hr=()=>{if(!ce)return;ce.focus();let e=ce.value.trim();!e||(ce.value="",it(e))},cn=or((e,t)=>{ct({done:!1,text:t,id:e})},500);f(T("todo-delete:click"),({xid:e=""})=>{lt(e)});f(T("create-todo:click"),()=>{hr()});f(je("new-item-text:keyup"),({ev:e})=>{e.key==="Enter"&&hr()});f(je("todo-text:keyup"),({ev:e,xid:t=""})=>{let{value:r}=e.target;typeof r=="string"&&cn(t,r)});f(Ue,({todoId:e})=>{let t=le&&v({el:le,xname:"todo",xid:e});t&&le?.removeChild(t)});f(De,({todo:e})=>{le?.appendChild(fr(e))});var gr=()=>Elem("div",null,Elem("div",null,Elem("input",{xname:"new-item-text"}),"\xA0",Elem("button",{xname:"create-todo"},"Add")),Elem("ol",{xname:"items"})),xr=async()=>{le=v({xname:"items"}),ce=v({xname:"new-item-text"}),ce?.focus(),await ut(),le?.replaceChildren(...st().map(fr)),console.log("ViewTodo mounted!")};var ln=P`
  -label: view-migration;

  textarea {
    margin-top: 10px;
    width: 500px;
    height: 400px;
  }
`,Pe=null;f(T("migration-export:click"),()=>{let e=me(),t=J();q(Pe,JSON.stringify({instruments:t,wallets:e},null,2)),Pe?.select()});f(T("migration-import:click"),async()=>{if(!!confirm("WARNING! This will replace *ALL* INSTRUMENT AND WALLET  data in local storage!"))try{let{wallets:e,instruments:t}=JSON.parse(K(Pe,""));console.log({wallets:e,instruments:t}),await ft(t),await yt(e),x(U,{})}catch(e){alert("Failed to load data: "+e)}});var wr=()=>Elem("div",{class:ln},Elem("div",null,Elem(O,{xname:"migration-export"},"Export from LS")," ",Elem(O,{xname:"migration-import"},"Import to LS")),Elem("textarea",{xname:"buffer"})),yr=async()=>{Pe=v({xname:"buffer"}),console.log("ViewMigration mounted!")};var Ve={home:{component:rr,onMount:nr,label:"Home"},instruments:{component:cr,onMount:ir,label:"Instruments"},wallets:{component:mr,onMount:pr,label:"Wallets"},todo:{component:gr,onMount:xr,label:"Todo"},migration:{component:wr,onMount:yr,label:"Data migration"}},vr=()=>{let{component:e,onMount:t,label:r}=Ve[Ee()]||Ve.home;return{component:e(),onMount:t,label:r}};var un=P`
  -label: top-bar;

  a {
    color: red;
    text-decoration: none;
  }
`,br=()=>{let[,...e]=Object.entries(Ve);return Elem("div",{class:un},Elem(Qe,{href:"/"},Elem("h1",null,"Investment tracker")),e.map(([t,r],n)=>Elem(Frag,null,n>0?" | ":"",Elem(Qe,{view:t},r.label))))};tr`
  body {
    //background: lime;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  a {
    color: blue;
    text-decoration: none;
  }
  h1 { /* app title */
    display: inline-block;
    margin: 0;
    margin-right: 20px;
    font-size: 1.5rem;
    color: black;

  }
  h2 { /* view title */
    font-size: 1.2rem;
  }

  input[type="date"] {
    padding: 0;
    font-size: 13px;
    width: 115px;
  }
  input[type="date"]::-webkit-inner-spin-button,
  input[type="date"]::-webkit-calendar-picker-indicator {
    margin: 0;
    padding: 1px;
  }
`;var Er=null,Sr=async()=>{let{component:e,onMount:t}=vr();return Er?.replaceChildren(e),t()};f(be,e=>{console.log("went to",Ee(),e.newUrl.href),Sr()});var Tr=()=>Elem("div",null,Elem(br,null),Elem("hr",null),Elem("div",{xname:"current-view"})),Ir=async()=>{Er=v({xname:"current-view"}),await Sr(),console.log("App mounted!")};vt();document.body.appendChild(Elem(Tr,null));Ir();})();
